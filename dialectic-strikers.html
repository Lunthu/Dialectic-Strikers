<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dialectic Strikers - Philosopher Football Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #2c5530, #1a3a1e);
            color: #f5f5f5;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .subtitle {
            text-align: center;
            font-style: italic;
            margin-bottom: 30px;
            color: #d4d4d4;
        }
        
        .game-setup {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .team-selection {
            flex: 1;
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #4a7c59;
        }
        
        .team-header {
            text-align: center;
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #8fbc8f;
        }
        
        .player-card {
            background: rgba(255,255,255,0.1);
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #8fbc8f;
            transition: all 0.3s ease;
        }
        
        .player-card:hover {
            background: rgba(255,255,255,0.15);
            transform: translateX(5px);
        }
        
        .player-name {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .player-role {
            color: #b8d4b8;
            font-style: italic;
            margin-bottom: 8px;
        }
        
        .player-stats {
            display: flex;
            gap: 15px;
            font-size: 0.9em;
        }
        
        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .stat-name {
            color: #9fb89f;
            font-size: 0.8em;
        }
        
        .stat-value {
            font-weight: bold;
            color: #c8e6c9;
        }
        
        .tactics-section {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .tactics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .tactic-card {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .tactic-card:hover {
            background: rgba(255,255,255,0.15);
        }
        
        .tactic-card.selected {
            border-color: #8fbc8f;
            background: rgba(143,188,143,0.2);
        }
        
        .start-match-btn {
            display: block;
            width: 200px;
            margin: 20px auto;
            padding: 15px;
            background: linear-gradient(45deg, #4a7c59, #5d8c6a);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .start-match-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .match-screen {
            display: none;
        }
        
        .match-header {
            background: rgba(0,0,0,0.4);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .score-display {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .match-time {
            font-size: 1.5em;
            color: #8fbc8f;
        }
        
        .pitch-container {
            background: linear-gradient(90deg, #2d5016, #4a7c2d);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 400px;
            position: relative;
            border: 3px solid #6b8e23;
        }
        
        .pitch-lines {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }
        
        .center-line {
            position: absolute;
            top: 20px;
            bottom: 20px;
            left: 50%;
            width: 2px;
            background: rgba(255,255,255,0.6);
        }
        
        .center-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100px;
            height: 100px;
            border: 2px solid rgba(255,255,255,0.6);
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }
        
        .player-dot {
            position: absolute;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            transition: all 0.5s ease;
            border: 2px solid white;
            z-index: 10;
        }
        
        .player-dot.greek {
            background: #4169e1;
        }
        
        .player-dot.german {
            background: #dc143c;
        }
        
        .ball {
            position: absolute;
            width: 10px;
            height: 10px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            z-index: 15;
        }
        
        .commentary-feed {
            background: rgba(0,0,0,0.4);
            border-radius: 10px;
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .commentary-line {
            margin: 10px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            border-left: 3px solid #8fbc8f;
            animation: fadeIn 0.5s ease;
        }
        
        .commentary-line.goal {
            border-left-color: #ffd700;
            background: rgba(255,215,0,0.1);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .control-btn {
            padding: 10px 20px;
            background: rgba(74,124,89,0.8);
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }
        
        .control-btn:hover {
            background: rgba(74,124,89,1);
        }
        
        .momentum-bars {
            display: flex;
            gap: 20px;
            margin: 15px 0;
            justify-content: center;
        }
        
        .momentum-bar {
            text-align: center;
        }
        
        .momentum-fill {
            width: 200px;
            height: 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .momentum-progress {
            height: 100%;
            transition: width 0.5s ease;
            background: linear-gradient(90deg, #4169e1, #8fbc8f, #dc143c);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚öΩ Dialectic Strikers - Philosopher Football Manager ‚öΩ</h1>
        <p class="subtitle">"Where every tackle doubles as a jab at a grand theory"</p>
        
        <div id="setup-screen">
            <div class="game-setup">
                <div class="team-selection">
                    <h3 class="team-header">üèõÔ∏è Ancient Greeks</h3>
                    <div id="greek-team"></div>
                </div>
                
                <div class="team-selection">
                    <h3 class="team-header">üé≠ Classical Germans</h3>
                    <div id="german-team"></div>
                </div>
            </div>
            
            <div class="tactics-section">
                <h3>Choose Your Tactical Philosophy</h3>
                <div class="tactics-grid" id="tactics-grid"></div>
            </div>
            
            <button class="start-match-btn" onclick="startMatch()">Begin the Philosophical Clash!</button>
        </div>
        
        <div id="match-screen" class="match-screen">
            <div class="match-header">
                <div class="match-time" id="match-time">00:00</div>
                <div class="score-display">
                    <span id="greek-score">0</span> - <span id="german-score">0</span>
                </div>
                <div style="font-size: 1.2em; margin-top: 10px;">
                    Ancient Greeks vs Classical Germans
                </div>
                
                <div class="momentum-bars">
                    <div class="momentum-bar">
                        <div>Greek Momentum</div>
                        <div class="momentum-fill">
                            <div class="momentum-progress" id="greek-momentum" style="width: 50%"></div>
                        </div>
                    </div>
                    <div class="momentum-bar">
                        <div>German Momentum</div>
                        <div class="momentum-fill">
                            <div class="momentum-progress" id="german-momentum" style="width: 50%"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="pitch-container" id="pitch">
                <div class="pitch-lines">
                    <div class="center-line"></div>
                    <div class="center-circle"></div>
                </div>
            </div>
            
            <div class="controls">
                <button class="control-btn" onclick="pauseMatch()">‚è∏Ô∏è Pause</button>
                <button class="control-btn" onclick="adjustSpeed()">‚è© Speed: <span id="speed-display">1x</span></button>
                <button class="control-btn" onclick="adjustTactic('defensive')">üõ°Ô∏è Defensive</button>
                <button class="control-btn" onclick="adjustTactic('attacking')">‚öîÔ∏è Attacking</button>
                <button class="control-btn" onclick="adjustTactic('counter')">üèÉ Counter</button>
            </div>
            
            <div class="commentary-feed" id="commentary"></div>
            
            <button class="start-match-btn" onclick="resetGame()" style="margin-top: 20px;">New Match</button>
        </div>
    </div>

    <script>
        // Game data
        const greekTeam = [
            {
                name: "Socrates",
                role: "Midfield Interrogator (C)",
                dialectic: 95, idealism: 70, empiricism: 60, rhetoric: 90, will: 75,
                trait: "Socratic Elenchus",
                weakness: "Shooting"
            },
            {
                name: "Plato",
                role: "Playmaking Idealist",
                dialectic: 85, idealism: 95, empiricism: 50, rhetoric: 80, will: 70,
                trait: "Allegory of the Cave",
                weakness: "Empiricism"
            },
            {
                name: "Aristotle",
                role: "Holding Regista",
                dialectic: 90, idealism: 75, empiricism: 95, rhetoric: 70, will: 80,
                trait: "Golden Mean",
                weakness: "Flair"
            },
            {
                name: "Heraclitus",
                role: "Drifting Winger",
                dialectic: 70, idealism: 80, empiricism: 65, rhetoric: 75, will: 95,
                trait: "Everything Flows",
                weakness: "Consistency"
            },
            {
                name: "Diogenes",
                role: "Pressing Forward",
                dialectic: 60, idealism: 65, empiricism: 70, rhetoric: 95, will: 85,
                trait: "Barrel Life",
                weakness: "Team Cohesion"
            }
        ];

        const germanTeam = [
            {
                name: "Kant",
                role: "Deep-lying Organizer (C)",
                dialectic: 85, idealism: 95, empiricism: 80, rhetoric: 75, will: 70,
                trait: "Categorical Imperative",
                weakness: "Pace"
            },
            {
                name: "Hegel",
                role: "Box-to-box Dialectician",
                dialectic: 95, idealism: 85, empiricism: 70, rhetoric: 80, will: 85,
                trait: "Absolute Spirit",
                weakness: "Risky Turnovers"
            },
            {
                name: "Schopenhauer",
                role: "Defensive Destroyer",
                dialectic: 75, idealism: 60, empiricism: 85, rhetoric: 70, will: 95,
                trait: "Pessimist's Edge",
                weakness: "Morale Drainer"
            },
            {
                name: "Nietzsche",
                role: "Poacher of Meaning",
                dialectic: 70, idealism: 80, empiricism: 65, rhetoric: 85, will: 95,
                trait: "Eternal Recurrence",
                weakness: "Passes"
            },
            {
                name: "Fichte",
                role: "Energetic Presser",
                dialectic: 80, idealism: 90, empiricism: 70, rhetoric: 75, will: 85,
                trait: "I-hood Rush",
                weakness: "Finishing"
            }
        ];

        const tactics = [
            {
                name: "Platonic Ideal Counter",
                description: "Deep block with visionary breaks (Idealism focus)",
                style: "counter"
            },
            {
                name: "Categorical Press",
                description: "High structure, disciplined press (Kant's order)",
                style: "press"
            },
            {
                name: "Barrel Blitz",
                description: "All-gas cynic swarm (Chaos incarnate)",
                style: "chaos"
            },
            {
                name: "Golden Mean Midblock",
                description: "Balanced Aristotelian geometry",
                style: "balanced"
            },
            {
                name: "Dialectical Overload",
                description: "Hegelian chains on one flank",
                style: "dialectical"
            }
        ];

        const commentaryLines = {
            socrates: {
                pass_success: ["Socrates performs an elenchus‚Äîquestion by question, the defense admits the pass.", "A Socratic dialogue unfolds: 'Do you know you have the ball?' 'No.' 'Then you don't.'"],
                tackle_win: ["Objection sustained! A cross-examination ends with the ball pleading guilty.", "Know thyself‚Äîand know where the ball is. Socrates demonstrates both."],
                shot_miss: ["The unexamined shot is not worth taking. This one proves the point."],
                goal: ["I know that I know nothing‚Äîexcept how to find the net!"]
            },
            plato: {
                pass_success: ["From the cave to the sun‚ÄîPlato finds the Form of the perfect pass.", "An ideal pass, cast from the realm of perfect geometry."],
                shot_miss: ["Alas, only a shadow of a goal appears on the wall.", "The physical ball fails to match its perfect Form."],
                goal: ["The Republic approves: justice served, striker liberated from the cave of defeat!"],
                assist: ["Philosopher-king creates, striker receives‚Äîthe ideal city in motion."]
            },
            aristotle: {
                interception: ["Empirical observation: the ball goes here. Conclusion: mine.", "The syllogism completes itself: All balls can be intercepted. This is a ball. Therefore..."],
                pass_success: ["The Golden Mean‚Äîneither hoofed nor overcooked.", "Virtue ethics in action: the mean between cowardice and recklessness."],
                goal: ["Excellence is not an act but a habit‚Äîand what a habitual finish!"]
            },
            heraclitus: {
                dribble_win: ["You never dribble the same defender twice‚Äîhe flows right past.", "Change is the only constant, and so is beating that fullback."],
                momentum_swing: ["Flux favors the bold!", "The river of play changes course!"],
                pass_success: ["All is flux‚Äîincluding this delightful through-ball."]
            },
            diogenes: {
                press_win: ["Diogenes leaves his barrel to dispossess the unsuspecting.", "Shameless pressing‚Äîthe cynic way!"],
                tackle_win: ["He's searching for an honest defender. No luck.", "Virtue? I spit on virtue‚Äîand take your ball too."],
                goal: ["A goal scored with the conviction of a man who has nothing left to lose!"]
            },
            kant: {
                pass_success: ["Synthetic a priori: the pass was true before it was struck.", "By categorical imperative, this pass was morally necessary."],
                shape_hold: ["Duty calls, and the back line answers in unison.", "The moral law within organizes the defensive line without."],
                interception: ["Reason triumphs over impulse‚Äîball recovered through pure practical logic."]
            },
            hegel: {
                combination_play: ["Thesis, antithesis... synthesis! A one-two becomes a higher unity.", "The dialectical process reaches its logical conclusion‚Äîin the opponent's net!"],
                turnover: ["Dialectic goes dialect-wrong.", "Even the Absolute Spirit has off days."],
                goal: ["History culminates in this moment‚Äîthe Geist finds expression through football!"]
            },
            schopenhauer: {
                interception: ["Will triumphs, representation stumbles.", "The world is will‚Äîand this will wants the ball."],
                tackle_win: ["Pessimism pays off: he expected the worst and prepared accordingly.", "The world as will and representation‚Äîmostly will in this tackle."],
                team_effect: ["The world is suffering‚Äîespecially that first touch.", "Schopenhauer's grimace affects team morale..."]
            },
            nietzsche: {
                goal: ["Behold the √úber-striker! A will-to-power finish.", "God is dead, but this finish is eternal!"],
                miss: ["If you stare into the keeper, the keeper stares back.", "That which does not kill the goal attempt makes it... still a miss."],
                comeback: ["What doesn't destroy me makes me stronger‚Äîliterally!"]
            },
            fichte: {
                press_win: ["The I asserts itself‚Äîpossession redefined.", "Self-consciousness in action: I press, therefore I am!"],
                tackle_win: ["The absolute I encounters the empirical not-I and wins the ball."]
            }
        };

        let gameState = {
            greekScore: 0,
            germanScore: 0,
            matchTime: 0,
            matchRunning: false,
            greekMomentum: 50,
            germanMomentum: 50,
            selectedTactic: null,
            gameInterval: null,
            ball: { x: 50, y: 50 },
            greekPlayers: [],
            germanPlayers: [],
            gameSpeed: 1, // 1x, 2x, 4x speed multiplier
            tickCounter: 0, // For tracking sub-second updates at 20 ticks/sec
            ballPossession: null, // Which player has the ball
            ballTarget: null, // Where ball is moving to
            ballSpeed: 0 // Ball movement speed
        };

        // Initialize the game
        function initializeGame() {
            renderTeams();
            renderTactics();
            setupPitch();
        }

        function renderTeams() {
            const greekDiv = document.getElementById('greek-team');
            const germanDiv = document.getElementById('german-team');

            greekDiv.innerHTML = greekTeam.map(player => createPlayerCard(player)).join('');
            germanDiv.innerHTML = germanTeam.map(player => createPlayerCard(player)).join('');
        }

        function createPlayerCard(player) {
            return `
                <div class="player-card">
                    <div class="player-name">${player.name}</div>
                    <div class="player-role">${player.role}</div>
                    <div class="player-stats">
                        <div class="stat">
                            <div class="stat-name">Dialectic</div>
                            <div class="stat-value">${player.dialectic}</div>
                        </div>
                        <div class="stat">
                            <div class="stat-name">Idealism</div>
                            <div class="stat-value">${player.idealism}</div>
                        </div>
                        <div class="stat">
                            <div class="stat-name">Will</div>
                            <div class="stat-value">${player.will}</div>
                        </div>
                        <div class="stat">
                            <div class="stat-name">Rhetoric</div>
                            <div class="stat-value">${player.rhetoric}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderTactics() {
            const tacticsGrid = document.getElementById('tactics-grid');
            tacticsGrid.innerHTML = tactics.map((tactic, index) => `
                <div class="tactic-card" onclick="selectTactic(${index})">
                    <h4>${tactic.name}</h4>
                    <p>${tactic.description}</p>
                </div>
            `).join('');
        }

        function selectTactic(index) {
            document.querySelectorAll('.tactic-card').forEach(card => card.classList.remove('selected'));
            document.querySelectorAll('.tactic-card')[index].classList.add('selected');
            gameState.selectedTactic = tactics[index];
        }

        function setupPitch() {
            const pitch = document.getElementById('pitch');
            
            // Initialize player positions
            gameState.greekPlayers = greekTeam.map((player, index) => ({
                ...player,
                x: 20 + (index * 15),
                y: 30 + (index % 3) * 20,
                id: `greek-${index}`
            }));
            
            gameState.germanPlayers = germanTeam.map((player, index) => ({
                ...player,
                x: 80 - (index * 15),
                y: 30 + (index % 3) * 20,
                id: `german-${index}`
            }));
        }

        function startMatch() {
            if (!gameState.selectedTactic) {
                alert("Please select a tactical philosophy before starting!");
                return;
            }

            document.getElementById('setup-screen').style.display = 'none';
            document.getElementById('match-screen').style.display = 'block';
            
            gameState.matchRunning = true;
            gameState.matchTime = 0;
            gameState.greekScore = 0;
            gameState.germanScore = 0;
            gameState.ballPossession = null;
            gameState.ballTarget = null;
            gameState.ballSpeed = 0;
            
            renderPitchPlayers();
            startMatchLoop();
            
            // Start with a random player having possession
            const allPlayers = [...gameState.greekPlayers, ...gameState.germanPlayers];
            gameState.ballPossession = allPlayers[Math.floor(Math.random() * allPlayers.length)];
            
            addCommentary("The whistle blows! Philosophy meets football in this unprecedented clash of minds and boots!");
        }

        function renderPitchPlayers() {
            const pitch = document.getElementById('pitch');
            
            // Clear existing players
            pitch.querySelectorAll('.player-dot, .ball').forEach(el => el.remove());
            
            // Add Greek players
            gameState.greekPlayers.forEach(player => {
                const dot = document.createElement('div');
                dot.className = 'player-dot greek';
                dot.style.left = `${player.x}%`;
                dot.style.top = `${player.y}%`;
                dot.title = player.name;
                pitch.appendChild(dot);
            });
            
            // Add German players
            gameState.germanPlayers.forEach(player => {
                const dot = document.createElement('div');
                dot.className = 'player-dot german';
                dot.style.left = `${player.x}%`;
                dot.style.top = `${player.y}%`;
                dot.title = player.name;
                pitch.appendChild(dot);
            });
            
            // Add ball
            const ball = document.createElement('div');
            ball.className = 'ball';
            ball.style.left = `${gameState.ball.x}%`;
            ball.style.top = `${gameState.ball.y}%`;
            pitch.appendChild(ball);
        }

        function startMatchLoop() {
            // 20 ticks per second = 50ms intervals
            gameState.gameInterval = setInterval(() => {
                if (!gameState.matchRunning) return;
                
                gameState.tickCounter += gameState.gameSpeed;
                
                // Update match time every 20 ticks (every real second at 1x speed)
                if (gameState.tickCounter >= 20) {
                    gameState.matchTime += 1;
                    gameState.tickCounter -= 20;
                    updateMatchDisplay();
                }
                
                simulateGameTick();
                
                if (gameState.matchTime >= 360) { // 6 minutes
                    endMatch();
                }
            }, 50); // 50ms = 20 times per second
        }

        function updateMatchDisplay() {
            const minutes = Math.floor(gameState.matchTime / 60);
            const seconds = gameState.matchTime % 60;
            document.getElementById('match-time').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            document.getElementById('greek-score').textContent = gameState.greekScore;
            document.getElementById('german-score').textContent = gameState.germanScore;
            
            document.getElementById('greek-momentum').style.width = `${gameState.greekMomentum}%`;
            document.getElementById('german-momentum').style.width = `${gameState.germanMomentum}%`;
        }

        function simulateGameTick() {
            // Simple simulation logic
            const randomEvent = Math.random();
            const currentPlayer = Math.random() < 0.5 ? 
                gameState.greekPlayers[Math.floor(Math.random() * greekTeam.length)] :
                gameState.germanPlayers[Math.floor(Math.random() * germanTeam.length)];
            
            if (randomEvent < 0.02) { // Goal chance
                simulateGoal(currentPlayer);
            } else if (randomEvent < 0.05) { // Shot
                simulateShot(currentPlayer);
            } else if (randomEvent < 0.15) { // Notable action
                simulateAction(currentPlayer);
            }
            
            // Move players slightly
            movePlayersRandomly();
        }

        function simulateGoal(player) {
            const isGreek = gameState.greekPlayers.includes(player);
            if (isGreek) {
                gameState.greekScore++;
                gameState.greekMomentum = Math.min(100, gameState.greekMomentum + 20);
                gameState.germanMomentum = Math.max(0, gameState.germanMomentum - 15);
            } else {
                gameState.germanScore++;
                gameState.germanMomentum = Math.min(100, gameState.germanMomentum + 20);
                gameState.greekMomentum = Math.max(0, gameState.greekMomentum - 15);
            }
            
            const lines = commentaryLines[player.name.toLowerCase()];
            const goalLine = lines?.goal?.[0] || `${player.name} scores! Philosophy meets net!`;
            addCommentary(goalLine, true);
            
            // Move ball to goal area momentarily, then reset to center
            if (isGreek) {
                moveBallTo(95, 50, 3);
            } else {
                moveBallTo(5, 50, 3);
            }
            
            setTimeout(() => {
                resetBallToCenter();
                gameState.ballPossession = null;
            }, 1000);
        }

        function moveBallTo(targetX, targetY, speed) {
            gameState.ballTarget = { x: targetX, y: targetY };
            gameState.ballSpeed = speed;
        }

        function resetBallToCenter() {
            moveBallTo(50, 50, 2);
            gameState.ballPossession = null;
        }

        function updateBallPosition() {
            // If ball has a target, move towards it
            if (gameState.ballTarget) {
                const dx = gameState.ballTarget.x - gameState.ball.x;
                const dy = gameState.ballTarget.y - gameState.ball.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance > 1) {
                    // Move towards target
                    const moveX = (dx / distance) * gameState.ballSpeed;
                    const moveY = (dy / distance) * gameState.ballSpeed;
                    
                    gameState.ball.x = Math.max(5, Math.min(95, gameState.ball.x + moveX));
                    gameState.ball.y = Math.max(5, Math.min(95, gameState.ball.y + moveY));
                } else {
                    // Reached target
                    gameState.ball.x = gameState.ballTarget.x;
                    gameState.ball.y = gameState.ballTarget.y;
                    gameState.ballTarget = null;
                    gameState.ballSpeed = 0;
                }
            }
            // If a player has possession, keep ball near them
            else if (gameState.ballPossession) {
                const player = gameState.ballPossession;
                const targetX = player.x + (Math.random() - 0.5) * 3; // Small offset
                const targetY = player.y + (Math.random() - 0.5) * 3;
                
                gameState.ball.x = Math.max(5, Math.min(95, targetX));
                gameState.ball.y = Math.max(5, Math.min(95, targetY));
            }
        }

        function simulateShot(player) {
            const lines = commentaryLines[player.name.toLowerCase()];
            const missLine = lines?.shot_miss?.[0] || lines?.miss?.[0] || 
                `${player.name} takes a shot but the keeper denies enlightenment!`;
            addCommentary(missLine);
            
            // Ball moves towards goal then bounces back
            const isGreek = gameState.greekPlayers.includes(player);
            const goalX = isGreek ? 95 : 5;
            moveBallTo(goalX, 50 + (Math.random() - 0.5) * 20, 4);
            
            // After a short delay, ball bounces to a random position
            setTimeout(() => {
                const randomX = 30 + Math.random() * 40;
                const randomY = 30 + Math.random() * 40;
                moveBallTo(randomX, randomY, 2);
                gameState.ballPossession = null;
            }, 500);
        }

        function simulateAction(player) {
            const actions = ['pass_success', 'tackle_win', 'interception', 'dribble_win'];
            const action = actions[Math.floor(Math.random() * actions.length)];
            
            const lines = commentaryLines[player.name.toLowerCase()];
            const actionLine = lines?.[action]?.[Math.floor(Math.random() * (lines[action]?.length || 1))] ||
                `${player.name} demonstrates ${action.replace('_', ' ')} with philosophical flair!`;
            
            addCommentary(actionLine);
            
            // Ball logic based on action
            if (action === 'pass_success') {
                // Pass to a teammate or nearby player
                const isGreek = gameState.greekPlayers.includes(player);
                const teammates = isGreek ? gameState.greekPlayers : gameState.germanPlayers;
                const nearbyTeammates = teammates.filter(t => t !== player);
                
                if (nearbyTeammates.length > 0) {
                    const target = nearbyTeammates[Math.floor(Math.random() * nearbyTeammates.length)];
                    gameState.ballPossession = target;
                    moveBallTo(target.x, target.y, 2);
                }
            } else if (action === 'tackle_win' || action === 'interception') {
                // Player wins ball
                gameState.ballPossession = player;
                moveBallTo(player.x, player.y, 1.5);
            } else if (action === 'dribble_win') {
                // Player keeps ball, moves forward
                gameState.ballPossession = player;
                const isGreek = gameState.greekPlayers.includes(player);
                const forwardX = isGreek ? Math.min(95, player.x + 10) : Math.max(5, player.x - 10);
                moveBallTo(forwardX, player.y, 1);
            }
            
            // Adjust momentum
            const isGreek = gameState.greekPlayers.includes(player);
            if (isGreek) {
                gameState.greekMomentum = Math.min(100, gameState.greekMomentum + 3);
                gameState.germanMomentum = Math.max(0, gameState.germanMomentum - 2);
            } else {
                gameState.germanMomentum = Math.min(100, gameState.germanMomentum + 3);
                gameState.greekMomentum = Math.max(0, gameState.greekMomentum - 2);
            }
        }

        function movePlayersRandomly() {
            // Much smaller movements for smooth 20fps animation
            gameState.greekPlayers.forEach(player => {
                player.x = Math.max(5, Math.min(95, player.x + (Math.random() - 0.5) * 0.1));
                player.y = Math.max(5, Math.min(95, player.y + (Math.random() - 0.5) * 0.1));
            });
            
            gameState.germanPlayers.forEach(player => {
                player.x = Math.max(5, Math.min(95, player.x + (Math.random() - 0.5) * 0.1));
                player.y = Math.max(5, Math.min(95, player.y + (Math.random() - 0.5) * 0.1));
            });
            
            // Update ball position based on new logic
            updateBallPosition();
            
            renderPitchPlayers();
        }

        function addCommentary(text, isGoal = false) {
            const commentary = document.getElementById('commentary');
            const line = document.createElement('div');
            line.className = `commentary-line ${isGoal ? 'goal' : ''}`;
            line.textContent = text;
            
            commentary.appendChild(line);
            commentary.scrollTop = commentary.scrollHeight;
            
            // Remove old lines if too many
            if (commentary.children.length > 20) {
                commentary.removeChild(commentary.firstChild);
            }
        }

        function pauseMatch() {
            gameState.matchRunning = !gameState.matchRunning;
            const btn = event.target;
            btn.textContent = gameState.matchRunning ? '‚è∏Ô∏è Pause' : '‚ñ∂Ô∏è Resume';
            
            if (gameState.matchRunning) {
                addCommentary("Match resumed! The philosophical battle continues...");
            } else {
                addCommentary("A pause for contemplation. Even philosophers need a breather.");
            }
        }

        function adjustTactic(style) {
            const tacticMessages = {
                defensive: "Falling back into a more contemplative formation‚Äîsometimes wisdom lies in patience.",
                attacking: "Forward, to glory! The offensive philosophy takes precedence!",
                counter: "Waiting for the perfect moment to strike‚Äîlike Socrates with a well-timed question."
            };
            
            addCommentary(tacticMessages[style] || "Tactical adjustment in progress...");
            
            // Adjust momentum based on tactic
            switch(style) {
                case 'defensive':
                    gameState.greekMomentum = Math.max(0, gameState.greekMomentum - 5);
                    break;
                case 'attacking':
                    gameState.greekMomentum = Math.min(100, gameState.greekMomentum + 5);
                    break;
                case 'counter':
                    // Balanced approach
                    break;
            }
        }

        function endMatch() {
            gameState.matchRunning = false;
            clearInterval(gameState.gameInterval);
            
            let endMessage;
            if (gameState.greekScore > gameState.germanScore) {
                endMessage = "The Ancient Greeks triumph! Philosophy's birthplace claims victory over its German inheritors!";
            } else if (gameState.germanScore > gameState.greekScore) {
                endMessage = "The Classical Germans prevail! Systematic thinking defeats ancient wisdom!";
            } else {
                endMessage = "A philosophical draw! Perhaps some questions are better left unanswered...";
            }
            
            addCommentary("‚è∞ Full time!");
            addCommentary(endMessage, true);
            addCommentary("And now for something completely different... the post-match analysis begins!");
        }

        function resetGame() {
            gameState = {
                greekScore: 0,
                germanScore: 0,
                matchTime: 0,
                matchRunning: false,
                greekMomentum: 50,
                germanMomentum: 50,
                selectedTactic: null,
                gameInterval: null,
                ball: { x: 50, y: 50 },
                greekPlayers: [],
                germanPlayers: [],
                gameSpeed: 1,
                tickCounter: 0,
                ballPossession: null,
                ballTarget: null,
                ballSpeed: 0
            };
            
            clearInterval(gameState.gameInterval);
            document.getElementById('setup-screen').style.display = 'block';
            document.getElementById('match-screen').style.display = 'none';
            document.getElementById('commentary').innerHTML = '';
            document.getElementById('speed-display').textContent = '1x';
            
            // Reset tactic selection
            document.querySelectorAll('.tactic-card').forEach(card => card.classList.remove('selected'));
        }

        // Special events that can occur randomly
        function triggerSpecialEvent() {
            const tickRate = 20;
            const events = [
                {
                    text: "üé≠ And now for something completely transcendent... Kant attempts a bicycle kick!",
                    probability: 0.01 / tickRate
                },
                {
                    text: "üìö VAR review by Mr. Pragma Tick: 'After consulting the archives, the decision stands!'",
                    probability: 0.005 / tickRate
                },
                {
                    text: "ü¶ú Dead Parrot VAR: 'This offside call is no more! It has ceased to be!'",
                    probability: 0.003 / tickRate
                },
                {
                    text: "üè∫ The chorus from the Athenian stands: 'PHILOSOPHIA! PHILOSOPHIA!'",
                    probability: 0.02 / tickRate
                },
                {
                    text: "üìñ Timeout for a seminar: Hegel explains why the goal was dialectically inevitable.",
                    probability: 0.01 / tickRate
                }
            ];
            
            events.forEach(event => {
                if (Math.random() < event.probability) {
                    addCommentary(event.text);
                }
            });
        }

        function adjustSpeed() {
            const speeds = [1, 2, 4];
            const currentIndex = speeds.indexOf(gameState.gameSpeed);
            const nextIndex = (currentIndex + 1) % speeds.length;
            gameState.gameSpeed = speeds[nextIndex];
            
            document.getElementById('speed-display').textContent = `${gameState.gameSpeed}x`;
            
            const speedMessages = {
                1: "Back to contemplative pace‚Äîphilosophy requires reflection.",
                2: "Accelerating the discourse‚Äîtwice the intellectual intensity!",
                4: "Maximum philosophical velocity‚Äîideas at light speed!"
            };
            
            addCommentary(speedMessages[gameState.gameSpeed]);
        }

        // Add special events to the game tick
        function simulateGameTick() {
            // Adjust event probabilities for 20 ticks per second
            const tickRate = 20; // 20 ticks per second
            const randomEvent = Math.random();
            const currentPlayer = Math.random() < 0.5 ? 
                gameState.greekPlayers[Math.floor(Math.random() * greekTeam.length)] :
                gameState.germanPlayers[Math.floor(Math.random() * germanTeam.length)];
            
            // Divide original probabilities by tick rate to maintain same frequency per second
            if (randomEvent < 0.02 / tickRate) { // Goal chance
                simulateGoal(currentPlayer);
            } else if (randomEvent < 0.05 / tickRate) { // Shot
                simulateShot(currentPlayer);
            } else if (randomEvent < 0.15 / tickRate) { // Notable action
                simulateAction(currentPlayer);
            }
            
            // Add special events (also adjusted for tick rate)
            triggerSpecialEvent();
            
            // Move players with smaller increments for smooth animation
            movePlayersRandomly();
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeGame);
    </script>
</body>
</html>
